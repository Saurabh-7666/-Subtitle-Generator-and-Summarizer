 Hello everyone and welcome to another exciting video on Cybersecurity by Idureka. In today's video, we will explore SSRF attacks, also known as Service Site Request for Jury, a critical vulnerability that can exploit the trust web service placed in internal resources. We will break down how SSRF attacks work, the dangers that bring to your web applications and most importantly, the steps you can take to secure your system from these threats. So whether you are a developer, a site security professional or someone eager to understand how attackers manipulate web servers to do their bidding, this video is packed with insights you won't want to miss. So first, let's take a look at our today's agenda. So first, we will understand what SSRF is next, we will see how SSRF works, then we will explore the impact of SSRF attacks and this attacks can cause serious problems like data leaks, internal network access or further system compromise. After that, we will look at the types of SSRF attacks. So, there are different forms including blind SSRF where attackers get no direct response but still cause damage. Next, we will dive deeper into blind SSRF. Finally, we will learn how to prevent SSRF using input validation, blocking internal IPs and limiting server access can help keep systems safe. And by the end of this video, you will have a thorough understanding of SSRF vulnerabilities and how to defend against them. But before we begin, please like, share and subscribe to Idureka's YouTube channel and hit the bell icon to stay updated on the latest content from Idureka. Also, check out the certified ethical hacking codes designed in partnership with AC Council to elevate your cybersecurity skills. This course offers a globally recognized CEHV13 AI certification and features 20 comprehensive modules that covered over 500 attack techniques enhanced by AI GPT tools. You will gain hands-on experience through 221 practical labs and benefit from round-clock support provided by certified professionals. It access to exclusive e-course web and an example to from the AC Council. This course is your gateway to mastering ethical hacking and securing a rebarging career in cyber defense. So, check out the course link given in the description box below. So, let's start by understanding SSRF or server side request forgery. SSRF is a security flaw that occurs when an attacker manipulates a web application or API to request internal resources. This internal resources could include sensitive data, private systems or even services that are not meant to be accessible externally. And by exploiting these vulnerabilities, attackers can potentially gain unauthorized access, expose sensitive data, compromise systems and even execute malicious code remotely. Now that we know what SSRF is, let's dive into how this vulnerability works. In a web application that allows users to import data from a URL, publish data to a URL or fetch data from a remote resource. But what if the application doesn't validate or sanitize the user provided URLs? So, the application becomes vulnerable to an SSRF attack. So, here's how it works. The attacker finds an input field, form or parameter in the application where they can specify a URL. And instead of providing a legitimate URL, the attacker craft a malicious one. So, this URL could point to internal systems, private APIs or even metadata services in cloud environments. For example, a common target is the metadata service in cloud servers which can be accessed via this. Then these services often store sensitive information such as configuration details or authentication keys. The server trusting the user's input process, this malicious URL and it makes a server-side request to a specified resource or knowingly carrying out the attacker's commands. So, through this manipulation, an attacker can access sensitive internal resources such as private database or rest APIs. Next, exploit resources that assume all requests from the server are trustworthy. Then scan internal systems to identify weaknesses or open ports. To extract sensitive data and expel trade to an external location they control, SSRF has become so prominent that it is listed among the old vaps top 10 vulnerabilities. A widely recognized list of the most critical web applications security risk. This highlights just how severe and common SSRF attacks are. Now that we understand how SSRF works, let's explore the real world impacts these attacks can have on organizations and their systems. A successful SSRF attack can have far reaching consequences. First, here we have unauthorized access. Attacters can gain access to sensitive configuration such as server finds, cloud metadata or even open ports. For example, they might extract credentials or manipulate configurations to further exploit the system. Next, internal ports scanning. With SSRF, attackers can perform internal network scans, identifying weak or unprotected services. This reconnaissance helps them plan more advanced attacks. Next, exploit chaining. SSRF vulnerabilities are often a stepping stone to most severe exploits, like remote code execution or reflected XSS attacks. This means a simple SSRF vulnerability can lead to a complete system compromise. And then we have malicious onward attacks. SSRF can exploit SSRF to launch malicious requests to external systems. These requests appear to originate from the victim organization leading to reputational damage. Now, let's talk about a real world examples of the devastating impact SSRF can have. In early 2024, a critical SSRF vulnerability, CVE-224-21893 in IvantiConnect Secure and Policies Secure Products was massively exploited. This flaw allowed attackers to bypass authentication and access restricted resources. And if we talk about its impact, over 170 unique IPs were used for attacks aiming to establish reverse shells and extract sensitive data. Great actors changed this vulnerability with others, achieving unauthenticated remote code execution. And over 28,000 Ivanti devices were identified as exploit across 145 countries with hundreds confirmed compromised. Organizations including the European Union issued urgent advices to mitigate the risk. So, this incident highlights the massive risk SSRF poses, especially in today's interconnected systems and cloud environments. So, now that we have explored the impact of SSRF attacks, let's see their different attacks. Understanding these categories will help you grab the various ways attackers exploit this vulnerability. So, here are the types of SSRF attacks. SSRF can manifest in different ways, depending on what the attackers is targeting. So, we will explore three primary types. First, attacks targeting the server itself. Next, cross-site port attacks. And finally, meta data exploitation in AWS, Azure and Oracle, cloud environments. First, we will talk about SSRF attacks where the server itself becomes the target. So, accessing restricted URLs. So, imagine a web application that lets user load content from a URL. Now, if there is no proper validation, an attacker could change the URL to something internal like this. Okay, so this could expose sensitive data or admin panels. Next, reading files on the server. So sometimes attackers use SSRF to access local files on the server. For example, they could craft a request to something like this. This might give them a list of system users, which is a valuable first step in hacking. Then, using uncommon protocols. SSRF can also abuse less common protocols like FTP or GoFur. For example, an attacker could send emails or interact with internal APIs using payloads like this. Next, let's examine cross-site port attacks or XSPA. So, in this type of attack, SSRF scans open ports or services inside a network. So first, we have scanning ports. An attacker could make the server check if the ports are open on the network, such as this. Next, we have probing private IPs. They might even scan private IP range like this. Here, as you can see on the screen. So this helps them map out the network and find services to target. Finally, we have exploitations of cloud metadata endpoints. This endpoint stores sensitive information like access keys, configurations and instance details. Now, let's see how this works for AWS Cloud. In AWS, there's a special endpoint that stores metadata. It's always available at this. So if attackers exploit SSRF to hit this endpoint, they can extract instance details like the server's hostname or IP address. Also, IAM role credentials which can look like this. So with this credentials, attackers might access AWS services or steal data. Now that we have exploit different types of SSRF attacks, let's take it a step further and examine blind SSRF vulnerability, which is a bit more challenging but equally fascinating. So now, we will explore blind SSRF and its potential impact and how attackers find and exploit this vulnerability. Plus, we will talk about some advanced techniques used to elevate blind SSRF attacks. So let's get into it. So first, what is blind SSRF? Blind SSRF occurs when a server processes a back-end history-tp request based on an attacker's URL. But the response isn't visible to the attackers in the front end. So you can make the server send requests to other systems but can't directly see the result. Now, let's talk about the impact. At the first glance, the impact of blind SSRF might seem lower compared to regular SSRF because you can't directly retrieve sensitive data. However, it's still dangerous because attackers can probe internal systems or hidden applications and they might uncover vulnerabilities like shell shock or exploit servers that haven't been passed. And in external cases, they could even achieve remote code execution gaining complete control over the server. While it's not always as direct, blind SSRF still poses a serious risk. So now comes the interesting part. How to find and exploit blind SSRF vulnerabilities? So first, is using out-of-brand techniques. The most effective way to detect blind SSRF is by using out-of-brand techniques also known as OASD. And here's how it works. You can create a unique domain name that point to a system you control. Next, send these domain names in your payloads to the vulnerable application. And if the application is vulnerable, it will make an HTTP request to your domain and you will detect that interaction. So this way, even though the server's response isn't visible to you, you can confirm its behavior in directly. Next is using burp collaborator. The easiest tool for performing OASD testing is burp collaborator. And here's how you can use it. First, generate a unique domain name in burp collaborator. Then inject this domain name into your payload and send it to the application. Next, monitor for interactions. Like DNS, lookups or HTTP requests from the application to your domain. So if you detect any interaction, then congratulations. You have found a blind SSRF vulnerability. Now that we have explored blind SSRF vulnerabilities and their potential impact. Let's talk about the techniques to prevent SSRF attacks effectively. Preventing SSRF attacks require a multi-layered approach. Since attackers can use creative ways to bypass simple defenses. And here are some of the best practices to mitigate SSRF risk. First we have avoid blacklist and use whitelist instead. So blacklist rely on blocking specific inputs. But attackers can easily bypass them using wildcard DNS services, HTTP redirects or alternate IP encoding. While whitelist only allows access to trusted IP addresses or DNS names that the application needs. So this limits the scope of potentially malicious request. Next preventing attack is validate and sanitize user input. To ensure that the user provided URLs are thoroughly validated. Also, reject requests to private IP addresses or disallowed domains. The next way to prevent attack is by handling server responses carefully. Never forward raw response bodies received from server initiated requests directly to the client. Instead, filter the responses and only rely expected data to prevent leaking sensitive server information to attackers. Next restrict URLs schemas. Allow only the necessary URLs schemas such as HTTP and HTTPs. Then unused schemas like file, go for or dictionary. To block attackers from exploiting these protocols. Next secure internal services. Many internal services for example, Redis, MongoDB or elastic research don't require authentication by default. Reforce authentication for all services, even those operating within local networks. Next monitor and block request. Implement logging for outgoing request initiated by the server. Analyze log-sregularly to identify abnormal patterns that might indicate SSRF attempts. Next leverage security tools and frameworks. Use web application firewalls or SSRF detection plugins to detect and block potential attacks in real time. And by combining these measures, you can significantly reduce the chances of SSRF vulnerabilities being exploited, making your applications more resilient against potential threats. And that's a wrap. So in this video, we explored the fascinating yet dangerous world of SSRF attacks. We started by understanding what SSRF is, how it works and its potential impacts. When moved into different types of SSRF attacks, we are world examples and even techniques like blind SSRF. And most importantly, we learnt how to safeguard against these vulnerabilities to keep your system secure. So if you enjoyed listening to this video, please be kind to like it and you can comment on any of your doubts and queries. We will reply to them earlier. And do look up for more videos and playlists and subscribe to Adurikas YouTube channel to learn more. Thank you for watching and Happy Learning!